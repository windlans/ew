软件介绍】

    EarthWorm是一种用于开启SOCKS v5代理服务的工具，基于标准C开发，可提供多平台间的转接通讯，用于复杂网络环境下的数据转发。
    专有主页：http ://rootkiter.com/EarthWorm/

【使用场景】

    普通网络环境：
        1.目标网络边界存在公网IP且可任意打开监听端口：

                  + --------- + + ------------------- +  
                  | HackTools | ->> | 8888-> 1.1.1.1 |
                  + --------- + + ------------------- +

                a）./ ew -s ssocksd -l 8888
                        //在1.1.1.1主机上通过这个命令开启8888延长的socks代理
                b）HackTools可通过访问1.1.1.1:8888扩展使用1.1.1.1主机提供的代理
                    
        2.目标网络边界不存在公网IP，需要通过反弹方式创建socks代理
            
                                        一台可控公网IP主机可控内网主机
                  + --------- + + -------------------------- + | + --------------- +
                  | HackTools | ->> | 1080-> 1.1.1.1-> 8888 | 防火墙| <-2.2.2.2 |
                  + --------- + + -------------------------- + | + --------------- +

                a）./ew -s rcsocks -l 1080 -e 8888
                            //在1.1.1.1的公网主机添加转接隧道，将1080收到的代理请求转寄反连8888运送的主机
                b）./ew -s rssocks -d 1.1.1.1 -e 8888          
                            //将目标网络的可控边界主机反向连接公网主机

                c）HackTools可通过访问1.1.1.1:1080扩展使用rssocks主机提供的socks5代理服务

    对于二重网络环境：        
        1.获得目标网络内两台主机A，B的权限，情况描述如下：

                A主机：存在公网IP，且自由监听任意端口，无法访问特定资源
                B主机：目标网络内部主机，可访问特定资源，但无法访问公网
                A主机可直连B主机
                
                                        可控边界主机A可访问指定资源的主机B
                  + --------- + + ----------------------- + + ------------- ---- +
                  | HackTools | ->> | 1080-> 2.2.2.2-> | ->> | 9999-> 2.2.2.3 |
                  + --------- + + ----------------------- + + ------------- ---- +

                a）./ew -s ssocksd -l 9999
                        //在2.2.2.3主机上利用ssocksd方式启动9999范围的socks代理
                b）./ew -s lcx_tran -l 1080 -f 2.2.2.3 -g 9999 
                        //将1080英尺收到的袜子代理请求转交给2.2.2.3的主机。
                c）HackTools可通过访问2.2.2.2:1080来使用2.2.2.3主机提供的socks5代理。
                
        2.获得目标网络内两台主机A，B的权限，情况描述如下：

                A主机：目标网络的边界主机，无公网IP，无法访问特定资源。
                B主机：目标网络内部主机，可访问特定资源，却无法回连连公网。

                A主机可直连B主机
                                      一台可控公网IP主机可控内网主机A可访问指定资源的主机B
                  + --------- + + -------------------------- + | + ----------------- + + ----------------- +
                  | HackTools | ->> | 1080-> 1.1.1.1-> 8888 | 防火墙| <-2.2.2.2-> | ->> | 9999-> 2.2.2.3 |
                  + --------- + + -------------------------- + | + ----------------- + + ----------------- +

                a）./ew -s lcx_listen -l 1080 -e 8888
                            //在1.1.1.1公网主机添加转接隧道，将1080收到的代理请求
                            //转交给反连8888机场的主机
                b）./ew -s ssocksd -l 9999
                            //在2.2.2.3主机上利用ssocksd方式启动9999范围的socks代理
                c）./ew -s lcx_slave -d 1.1.1.1 -e 8888 -f 2.2.2.3 -g 9999
                            //在2.2.2.2上，通过工具的lcx_slave方式，打通1.1.1.1:8888和2.2.2.3:9999之间的通讯隧道
                d）HackTools可通过访问1.1.1.1:1080来使用2.2.2.3主机提供的socks5代理


【参数说明】

    目前工具提供六种临界状态，可通过-s参数进行预测，分别为：

        ssocksd rcsocks rssocks   
        lcx_slave lcx_tran lcx_listen

        其中SOCKS5服务的核心逻辑支持由ssocksd和rssocks提供，分别对应正向与反向sosocks代理。

        其余的lcx在服务器之间的通路。
    
    lcx类别管道：

        lcx_slave该管道中断通过反弹方式连接代理请求方，另一侧连接代理提供主机。
        lcx_tran该管道，通过监听本地端口接收代理请求，并转交给代理提供主机。
        lcx_listen该管道，通过侦听本地端口接收数据，将其转换为目标网络回连的代理提供主机。
    
        通过组合lcx类别管道的特性，可以实现多层内网环境下的渗透测试。

        下面是一个三级跳的本地测试示例。。。
        ./ew -s rcsocks -l 1080 -e 8888
        ./ew -s lcx_slave -d 127.0.0.1 -e 8888 -f 127.0.0.1 -g 9999
        ./ew -s lcx_listen -l 9999 -e 7777
        ./ew -s rssocks -d 127.0.0.1 -e 7777

        数据流向为IE-> 1080-> 8888-> 9999-> 7777-> rssocks 

【补充说明】
        1.为了减少网络资源的消耗，程序中添加了超时机制，至少时间为10000毫秒（10秒），
          用户可以通过追加-t参数来调整这个值，单位为毫米。在多级级联功能中，超时机制
          将以隧道中最短的时间为替换值。
        2.单纯从设计原理上讲，多级级联的三个状态可以转发任意以TCP为基础的通讯服务，
          包括远程桌面／ web服务等。
        3.产品包中的ew_for_Arm32在开发者已有平台下（android手机，小米路由器，树莓派）测试无误。
          如果有其他异常环境变量对应的详细细节反馈给作者，刹车更新程序问题。

【联系作者】

    rootkiter@rootkiter.com
    如果您在使用中有什么好想法，或遇到什么BUG，都可以主动联系我。
    我会尽最大所创造的这个工具更加完美，感谢大家的支持。
